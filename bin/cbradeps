#!/usr/bin/ruby

require_relative "../lib/cbradeps"

def help_text
  <<-USAGE
cbradeps [OPTIONS] [application path]

Component-based Ruby/Rails dependency grapher.

Options are...
    -h, -H, --help                   Display this help message.
    -g, --graph                      Outputs graph.png to the current directory
    -d, --dot                        Outputs graph.dot to the current directory
  USAGE
end

case ARGV.size
  when 0
    Cbradeps.()
  when 1, 2
    param = ARGV[0]
    if %w(--help -h -H).include? param
      puts help_text
    elsif %w(-g --graph).include? param
      Cbradeps.output_graph ARGV.last
    elsif %w(-d --dot).include? param
      Cbradeps.output_dot ARGV.last
    else
      Cbradeps.output_as_text ARGV.last
    end
  else
    puts "Incorrect invocation. Please see help:\n\n"
    puts help_text
    exit 1
end
